import fs from "fs";

type StoneRule = Record<string, number>;
type StoneMaster = Record<string, StoneRule>;

class Solution {
    private stoneList: string[] = [];

    private numTo60: Record<string, number> = {
        "0": 43369895096,
        "1": 65961219181,
        "2": 63172165494,
        "3": 63230023120,
        "4": 61439053769,
        "5": 54373596862,
        "6": 57933790448,
        "7": 56988774248,
        "8": 55037373871,
        "9": 58780298247,
        "20": 70119463288,
        "24": 81925175789,
        "40": 68993460471,
        "48": 76637970226,
        "80": 64832257725,
        "96": 76875084060,
        "2024": 100139236592,
        "4048": 95834918754,
        "8096": 93157147262,
        "10120": 82527381401,
        "14168": 86488411300,
        "18216": 89198234571,
    };
    private numTo59: Record<string, number> = {
        "0": 28593873985,
        "1": 43369895096,
        "2": 41525589303,
        "3": 41578776877,
        "4": 40399586486,
        "5": 35800677601,
        "6": 38158143567,
        "7": 37533047662,
        "8": 36238383740,
        "9": 38716940493,
        "20": 46177216461,
        "24": 53962020131,
        "40": 45405888734,
        "48": 50429030020,
        "80": 42644226350,
        "96": 50512920912,
        "2024": 65961219181,
        "4048": 63172165494,
        "8096": 61439053769,
        "10120": 54373596862,
        "14168": 56988774248,
        "18216": 58780298247,
    };
    private numTo58: Record<string, number> = {
        "0": 18810542532,
        "1": 28593873985,
        "2": 27366673929,
        "3": 27385205762,
        "4": 26595346202,
        "5": 23546156396,
        "6": 25070272242,
        "7": 24671676894,
        "8": 23833683818,
        "9": 25442648670,
        "20": 30401453515,
        "24": 35559765666,
        "40": 29918980839,
        "48": 33253184655,
        "80": 28094872504,
        "96": 33344181265,
        "2024": 43369895096,
        "4048": 41525589303,
        "8096": 40399586486,
        "10120": 35800677601,
        "14168": 37533047662,
        "18216": 38716940493,
    };
    private numTo55: Record<string, number> = {
        "0": 5362947711,
        "1": 8161193535,
        "2": 7815929513,
        "3": 7821403715,
        "4": 7599067248,
        "5": 6723617334,
        "6": 7160643536,
        "7": 7045685002,
        "8": 6805591722,
        "9": 7266163233,
        "20": 8673940117,
        "24": 10136602415,
        "40": 8536974462,
        "48": 9484144709,
        "80": 8021482411,
        "96": 9517164084,
        "2024": 12380334344,
        "4048": 11846276236,
        "8096": 11516149089,
        "10120": 10208238298,
        "14168": 10698321736,
        "18216": 11033309991,
    };
    private numTo51: Record<string, number> = {
        "0": 1010392024,
        "1": 1529921658,
        "2": 1464254721,
        "3": 1466002423,
        "4": 1424046245,
        "5": 1262810287,
        "6": 1345613788,
        "7": 1323890750,
        "8": 1278299521,
        "9": 1365513047,
        "20": 1630441910,
        "24": 1906714172,
        "40": 1602775354,
        "48": 1780593710,
        "80": 1504321448,
        "96": 1782132108,
        "2024": 2327142660,
        "4048": 2230181584,
        "8096": 2170908709,
        "10120": 1920773112,
        "14168": 2013655038,
        "18216": 2077309718,
    };
    private numTo50: Record<string, number> = {
        "0": 663251546,
        "1": 1010392024,
        "2": 967190364,
        "3": 967436144,
        "4": 939523808,
        "5": 830902728,
        "6": 884539345,
        "7": 870467992,
        "8": 841069902,
        "9": 897592763,
        "20": 1072629280,
        "24": 1254513380,
        "40": 1056089110,
        "48": 1174092474,
        "80": 992208374,
        "96": 1178700335,
        "2024": 1529921658,
        "4048": 1464254721,
        "8096": 1424046245,
        "10120": 1262810287,
        "14168": 1323890750,
        "18216": 1365513047,
    };
    private numTo45: Record<string, number> = {
        "0": 81997335,
        "1": 125001266,
        "2": 119550250,
        "3": 119542610,
        "4": 116004670,
        "5": 102728207,
        "6": 109181845,
        "7": 107529561,
        "8": 103934296,
        "9": 110811935,
        "20": 132725699,
        "24": 155388606,
        "40": 130756517,
        "48": 145457402,
        "80": 122794495,
        "96": 146020913,
        "2024": 189148778,
        "4048": 181040219,
        "8096": 176169842,
        "10120": 156270923,
        "14168": 163892525,
        "18216": 169092081,
    };
    private numTo40: Record<string, number> = {
        "0": 10174278,
        "1": 15458147,
        "2": 14777945,
        "3": 14761601,
        "4": 14316637,
        "5": 12678459,
        "6": 13464170,
        "7": 13273744,
        "8": 12835708,
        "9": 13675794,
        "20": 16433346,
        "24": 19278962,
        "40": 16185152,
        "48": 18020591,
        "80": 15174975,
        "96": 18081009,
        "2024": 23333796,
        "4048": 22365694,
        "8096": 21807800,
        "10120": 19375816,
        "12144": 20675981,
        "14168": 20328089,
        "16192": 19605147,
        "18216": 20970437,
    };
    private numTo35: Record<string, number> = {
        "0": 1258125,
        "1": 1916299,
        "2": 1824910,
        "3": 1821382,
        "4": 1761823,
        "5": 1565585,
        "6": 1661899,
        "7": 1637097,
        "8": 1583522,
        "9": 1685448,
        "20": 2028032,
        "24": 2386184,
        "40": 1998086,
        "48": 2232336,
        "80": 1874184,
        "96": 2236711,
        "2024": 2886408,
        "4048": 2774273,
        "8096": 2709433,
        "10120": 2396146,
        "12144": 2567855,
        "14168": 2519878,
        "16192": 2428413,
        "18216": 2602817,
    };
    private numTo25: Record<string, number> = {
        "0": 19778,
        "1": 29165,
        "2": 27842,
        "3": 27569,
        "4": 26669,
        "5": 23822,
        "6": 25469,
        "7": 25071,
        "8": 24212,
        "9": 25793,
        "20": 31055,
        "24": 36669,
        "40": 30300,
        "48": 33975,
        "80": 28361,
        "96": 33874,
        "2024": 43726,
        "4048": 42646,
        "8096": 41994,
        "10120": 37090,
        "12144": 39648,
        "14168": 39034,
        "16192": 37525,
        "18216": 40124,
    };
    private numTo30: Record<string, number> = {
        "0": 156451,
        "1": 234511,
        "2": 223730,
        "3": 223231,
        "4": 216056,
        "5": 194545,
        "6": 205157,
        "7": 203252,
        "8": 196389,
        "9": 208558,
        "20": 252809,
        "24": 297140,
        "40": 248593,
        "48": 276645,
        "80": 232314,
        "96": 275877,
        "2024": 357632,
        "4048": 343711,
        "8096": 336192,
        "10120": 298191,
        "12144": 319620,
        "14168": 312940,
        "16192": 301170,
        "18216": 322818,
    };
    private numTo20: Record<string, number> = {
        "0": 2377,
        "1": 3572,
        "2": 3381,
        "3": 3347,
        "4": 3204,
        "5": 3053,
        "6": 3193,
        "7": 3165,
        "8": 3034,
        "9": 3216,
        "20": 3816,
        "24": 4452,
        "40": 3728,
        "48": 4193,
        "80": 3557,
        "96": 4164,
        "2024": 5602,
        "4048": 5463,
        "8096": 5280,
        "10120": 4529,
        "12144": 4917,
        "14168": 4762,
        "16192": 4580,
        "18216": 4888,
    };
    private numTo15: Record<string, number> = {
        "0": 328,
        "1": 418,
        "2": 414,
        "3": 401,
        "4": 390,
        "5": 383,
        "6": 401,
        "7": 413,
        "8": 393,
        "9": 419,
        "20": 495,
        "24": 564,
        "40": 469,
        "48": 508,
        "80": 439,
        "96": 512,
        "2024": 667,
        "4048": 661,
        "8096": 637,
        "10120": 597,
        "12144": 600,
        "14168": 602,
        "16192": 578,
        "18216": 586,
    };
    private numTo10: Record<string, number> = {
        "0": 39,
        "1": 62,
        "2": 57,
        "3": 52,
        "4": 47,
        "5": 45,
        "6": 54,
        "7": 52,
        "8": 48,
        "9": 54,
        "20": 50,
        "24": 60,
        "40": 50,
        "48": 61,
        "80": 51,
        "96": 64,
        "2024": 81,
        "4048": 92,
        "8096": 82,
        "10120": 67,
        "12144": 68,
        "14168": 72,
        "16192": 69,
        "18216": 70,
    };
    private numTo5: Record<string, number> = {
        "0": 4,
        "1": 7,
        "2": 6,
        "3": 5,
        "4": 4,
        "5": 8,
        "6": 8,
        "7": 8,
        "8": 7,
        "9": 8,
        "20": 8,
        "24": 8,
        "40": 8,
        "48": 8,
        "80": 8,
        "96": 8,
        "2024": 14,
        "4048": 12,
        "8096": 8,
        "10120": 8,
        "12144": 8,
        "14168": 8,
        "16192": 7,
        "18216": 8,
    };
    private stoneMaster: Record<string, number> = {
        "0": 1258125,
        "1": 1916299,
        "2": 1824910,
        "3": 1821382,
        "4": 1761823,
        "5": 1565585,
        "6": 1661899,
        "7": 1637097,
        "8": 1583522,
        "9": 1685448,
        "20": 2028032,
        "24": 2386184,
        "26": 2318424,
        "28": 2262282,
        "32": 2418847,
        "36": 2321141,
        "40": 1998086,
        "48": 2232336,
        "56": 2152988,
        "57": 2134836,
        "60": 1930326,
        "67": 2202566,
        "72": 2300272,
        "77": 2184414,
        "80": 1874184,
        "84": 2232336,
        "86": 2164576,
        "91": 2384477,
        "94": 2304471,
        "96": 2236711,
        "2024": 2886408,
        "2048": 2792670,
        "2457": 2949749,
        "2608": 2567074,
        "2867": 2920508,
        "2880": 2717329,
        "3277": 3006416,
        "3686": 2935614,
        "4048": 2774273,
        "6032": 2851396,
        "6072": 2779243,
        "8096": 2709433,
        "9184": 3018101,
        "9456": 2916630,
        "10120": 2396146,
        "12144": 2567855,
        "14168": 2519878,
        "16192": 2428413,
        "18216": 2602817,
        "20482880": 3626619,
        "24579456": 3849988,
        "28676032": 3794783,
        "32772608": 3669747,
        "36869184": 3910494,
    };
    private stone10: Record<string, number> = {
        "0": 39,
        "1": 62,
        "2": 57,
        "3": 52,
        "4": 47,
        "5": 45,
        "6": 54,
        "7": 52,
        "8": 48,
        "9": 54,
        "20": 50,
        "24": 60,
        "26": 62,
        "28": 61,
        "32": 65,
        "36": 67,
        "40": 50,
        "48": 61,
        "56": 64,
        "57": 64,
        "60": 52,
        "67": 64,
        "72": 62,
        "77": 64,
        "80": 51,
        "84": 61,
        "86": 63,
        "91": 71,
        "94": 62,
        "96": 64,
        "2024": 81,
        "2048": 84,
        "2457": 90,
        "2608": 72,
        "2867": 85,
        "2880": 79,
        "3277": 89,
        "3686": 92,
        "4048": 92,
        "6032": 83,
        "6072": 79,
        "8096": 82,
        "9184": 91,
        "9456": 93,
        "10120": 67,
        "12144": 68,
        "14168": 72,
        "16192": 69,
        "18216": 70,
        "20482880": 109,
        "24579456": 103,
        "28676032": 106,
        "32772608": 103,
        "36869184": 103,
    };
    private stone40: Record<string, number> = {
        "0": 10174278,
        "1": 15458147,
        "2": 14777945,
        "3": 14761601,
        "4": 14316637,
        "5": 68971649,
        "6": 186338961,
        "7": 430390310,
        "8": 1093865485,
        "9": 2606630725,
        "20": 77352231,
        "24": 46362658,
        "26": 76260379,
        "28": 1198034551,
        "32": 46625579,
        "36": 76275106,
        "40": 77104037,
        "48": 1241993089,
        "56": 2572209008,
        "57": 3768047077,
        "60": 6442970019,
        "67": 14078755929,
        "72": 21789691504,
        "77": 43532772156,
        "80": 44803570404,
        "84": 44772580831,
        "86": 51138446813,
        "91": 96013403353,
        "94": 192023763335,
        "96": 390411088181,
        "2024": 6286070412,
        "2048": 5158970865,
        "2457": 10197142584,
        "2608": 56082255850,
        "2867": 67423766421,
        "2880": 113426912458,
        "3277": 136627590165,
        "3686": 213751645937,
        "4048": 200627579802,
        "6032": 12098128634,
        "6072": 90978342195,
        "8096": 416788284156,
        "9184": 410415566307,
        "9456": 756850164230,
        "10120": 818081645293,
        "12144": 2670375129250,
        "14168": 5833004166737,
        "16192": 14828620634270,
        "18216": 35512046826620,
        "20482880": 450436002902,
        "24579456": 1772631975365,
        "28676032": 3582428341447,
        "32772608": 9161069360049,
        "36869184": 22330977616319,
    };
    private stoneMagic: string[] = [];
    private stoneDict: Record<string, number> = {};
    private stoneLegend: Record<string, Record<string, number>> = {};

    private readFile(filename: string) {
        return fs.readFileSync(`./${filename}`, "utf8").split(" ");
    }

    private magicalStoneUpdate() {
        let newStoneList = [];
        for (let stone of this.stoneList) {
            if (Number(stone) === 0) {
                newStoneList.push("1");
            } else if (stone.length % 2 === 0) {
                newStoneList.push(stone.substring(0, stone.length / 2));
                newStoneList.push(Number(stone.substring(stone.length / 2, stone.length)).toString());
            } else {
                newStoneList.push((Number(stone) * 2024).toString());
            }
        }
        this.stoneList = newStoneList;
    }

    private findSum(stone: string, times: number): number {
        if (times === 0) {
            return 1;
        }
        if (times === 10 && this.stone10[stone]) {
            return this.stone10[stone];
        }

        if (times === 35 && this.stoneMaster[stone]) {
            return this.stoneMaster[stone];
        }

        // if (times === 40 && this.stone40[stone]) {
        //     return this.stone40[stone];
        // }

        if (stone === "0") {
            return this.findSum("1", times - 1);
        } else if (stone.length % 2 === 0) {
            return this.findSum(stone.substring(0, stone.length / 2), times - 1) + this.findSum(Number(stone.substring(stone.length / 2, stone.length)).toString(), times - 1);
        } else {
            return this.findSum((Number(stone) * 2024).toString(), times - 1);
        }
    }

    private blink(times: number) {
        for (let i = 0; i < times; i++) {
            this.magicalStoneUpdate();
        }
    }

    private blinkStone(stone: string, times: number): number {
        let stoneMagicList = [stone];
        let newMagic = [];
        for (let i = 0; i < times; i++) {
            newMagic = [];
            for (let pebble of stoneMagicList) {
                if (Number(pebble) === 0) {
                    newMagic.push("1");
                } else if (pebble.length % 2 === 0) {
                    newMagic.push(pebble.substring(0, pebble.length / 2));
                    newMagic.push(Number(pebble.substring(pebble.length / 2, pebble.length)).toString());
                } else {
                    newMagic.push((Number(pebble) * 2024).toString());
                }
            }
            stoneMagicList = newMagic;
        }
        if (!this.stoneDict[stone]) {
            this.stoneDict[stone] = newMagic.length;
        }
        this.stoneList = newMagic;
        return newMagic.length;
    }

    private getSum(stringList: string[]) {
        return stringList.reduce((a, b) => Number(a) + Number(b), 0);
    }

    public solve() {
        this.stoneList = this.readFile("input.txt");
        // this.blink(15);
        // console.log(this.stoneList.length)
        // console.log(this.stoneList);
        // current stoneMaster is value when each goes by 35 then it's the sum i can use.
        // I need to find state at 40
        // 510613 358 84 40702 4373582 2 0 1584
        // let sum = 0;
        // for (const stone of this.stoneList) {
        //     sum += this.findSum(stone, 60);
        // }

        // console.log(sum);/'

        // const total = [28011995759413,
        // 17908613744340,
        // 39301315814110,
        // 30186133885613,
        // 28875238146080,
        // 32900842190026,
        // 22366879555762,
        // 52811796657708].reduce((a, b) => a+b, 0);
        // console.log(total);
        // for (let peb of Object.keys(this.stoneMaster)) {
        //     const howmany = this.findSum(peb, 40);
        //     console.log(howmany);
        //     this.stoneMaster[peb] = howmany;
        // }
        // console.log(this.stoneMaster);

        let total = 0
        let heysum = 0;
        for (let sone of this.stoneList) {
            heysum = this.findSum(sone, 75);
            console.log(heysum);
            total += heysum;
        }
        console.log('================')
        console.log(total)

        // console.log(this.findSum('510613', 75))
        // this.blinkStone('358', 40)
        // this.blinkStone('84', 40)
        // this.blinkStone('40702', 40)
        // this.blinkStone('4373582', 40)
        // this.blinkStone('2', 40)
        // this.blinkStone('0', 40)
        // this.blinkStone('1584', 40)
        // console.log(Object.keys(this.stoneMaster).length);
    }

    private num54: Record<string, number> = {
        "0": 3537156082,
        "1": 5362947711,
        "2": 5136784035,
        "3": 5144151283,
        "4": 4999818380,
        "5": 4429562772,
        "6": 4724206377,
        "7": 4645433144,
        "8": 4484326329,
        "9": 4792957707,
        "20": 5710511724,
        "24": 6669822620,
        "40": 5613596216,
        "48": 6232680020,
        "80": 5273369124,
        "96": 6242779965,
        "2024": 8161193535,
        "4048": 7815929513,
        "8096": 7599067248,
        "10120": 6723617334,
        "14168": 7045685002,
        "18216": 7266163233,
    };
    private num53: Record<string, number> = {
        "0": 1529921658,
        "1": 2327142660,
        "2": 2230181584,
        "3": 2232993017,
        "4": 2170908709,
        "5": 1920773112,
        "6": 2047645435,
        "7": 2013655038,
        "8": 1944190437,
        "9": 2077309718,
        "20": 2474646745,
        "24": 2888300966,
        "40": 2434438269,
        "48": 2702345766,
        "80": 2288691545,
        "96": 2711126835,
        "2024": 3537156082,
        "4048": 3383369064,
        "8096": 3286453556,
        "10120": 2910904745,
        "14168": 3049406611,
        "18216": 3144423073,
    };
}

const sol = new Solution();
sol.solve();
